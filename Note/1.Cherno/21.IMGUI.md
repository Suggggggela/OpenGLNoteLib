本节我们为cpp程序添加GUI的支持

## 1.imgui
视频中使用的是imgui1.6版本
https://github.com/ocornut/imgui/releases?page=7
直接将根目录所有头文件和cpp复制，同时复制example中的opengl3的示例代码

## 2.imgui集成
首先将imgui_impl_glfw_gl3.cpp中include的gl3w.h改为glew
首先在声明Renderer之后，while循环之前添加gui需要初始化的数据

```cpp
	//Renderer
	Renderer renderer;

	//imgui
	ImGui::CreateContext();
	ImGui_ImplGlfwGL3_Init(window, true);
	ImGui::StyleColorsDark();
	bool show_demo_window = true;
	bool show_another_window = false;

```
while循环中 ：
- 渲染前添加newframe
- 设置完Uniform之后添加gui元素
- 渲染完成后clear gui
```cpp
	/* Loop until the user closes the window */
	while (!glfwWindowShouldClose(window))
	{
		/* Render here */
		//GLCall(glClear(GL_COLOR_BUFFER_BIT));
		renderer.Clear();

		//imgui
		ImGui_ImplGlfwGL3_NewFrame();

		shader.Bind();
		shader.SetUniform4f("u_Color", r, 0.3f, 0.8f, 1.0f);

		renderer.Draw(vao, ibo, shader);
		//#bindVAO
		//vao.Bind();
		//ibo.Bind();
		//
		//GLCall(glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, nullptr));

		if (r > 1.0f)
		{
			increament = -0.05f;
		}
		else if (r < 0.0f)
		{
			increament = 0.05f;
		}
		r += increament * 0.1f;
		
		// example imgui ui element 
		{
			static float f = 0.0f;
			static int counter = 0;
			ImGui::Text("Hello, world!");                           // Display some text (you can use a format string too)
			ImGui::SliderFloat("float", &f, 0.0f, 1.0f);            // Edit 1 float using a slider from 0.0f to 1.0f    
			ImGui::ColorEdit3("clear color", (float*)&clear_color); // Edit 3 floats representing a color

			ImGui::Checkbox("Demo Window", &show_demo_window);      // Edit bools storing our windows open/close state
			ImGui::Checkbox("Another Window", &show_another_window);

			if (ImGui::Button("Button"))                            // Buttons return true when clicked (NB: most widgets return true when edited/activated)
				counter++;
			ImGui::SameLine();
			ImGui::Text("counter = %d", counter);

			ImGui::Text("Application average %.3f ms/frame (%.1f FPS)", 1000.0f / ImGui::GetIO().Framerate, ImGui::GetIO().Framerate);
		}
		//imgui
		ImGui::Render();
		ImGui_ImplGlfwGL3_RenderDrawData(ImGui::GetDrawData());

		/* Swap front and back buffers */
		glfwSwapBuffers(window);

		/* Poll for and process events */
		glfwPollEvents();
	}

	//imgui
	ImGui_ImplGlfwGL3_Shutdown();
	ImGui::DestroyContext();
	glfwTerminate();
	return 0;
}

```


## 3.使用gui控制Projection矩阵来移动正方形
接下来我们修改代码，将Projection的修改改为renderloop中，这样就可以通过gui在运行时修改了

```cpp
	//Renderer
	Renderer renderer;

	//imgui
	ImGui::CreateContext();
	ImGui_ImplGlfwGL3_Init(window, true);
	ImGui::StyleColorsDark();
	bool show_demo_window = true;
	bool show_another_window = false;

	float r = 0.0f;//Red Channel
	float increament = 0.05f;
	ImVec4 clear_color = ImVec4(0.45f, 0.55f, 0.60f, 1.00f);

	//#unbind everything
	//glBindVertexArray(0);//VAO
	//glBindBuffer(GL_ARRAY_BUFFER, 0);//vbo
	//glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);//ibo
	//glUseProgram(0);
	vao.Unbind();//VAO
	vbo.Unbind();//vbo
	ibo.Unbind();//ibo
	shader.UnBind();//shader

	//gui element
	glm::vec3 translation(200, 200, 0);
	glm::vec4 mainColor(0.0f, 0.3f, 0.8f,1.0f);

	/* Loop until the user closes the window */
	while (!glfwWindowShouldClose(window))
	{
		/* Render here */
		//GLCall(glClear(GL_COLOR_BUFFER_BIT));
		renderer.Clear();

		//imgui
		ImGui_ImplGlfwGL3_NewFrame();

		//use gui 
		glm::mat4 model = glm::translate(glm::mat4(1.0), translation);//Model空间向上移动200，向右移动200
		glm::mat4 mvp = projection * view * model;

		shader.Bind();
		//shader.SetUniform4f("u_Color", r, 0.3f, 0.8f, 1.0f);
		shader.SetUniform4f("u_Color", mainColor.r, mainColor.g, mainColor.b, mainColor.a);
		shader.SetUniformMat4f("u_MVP", mvp);

		renderer.Draw(vao, ibo, shader);
		//#bindVAO
		//vao.Bind();
		//ibo.Bind();
		//
		//GLCall(glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, nullptr));

		if (r > 1.0f)
		{
			increament = -0.05f;
		}
		else if (r < 0.0f)
		{
			increament = 0.05f;
		}
		r += increament * 0.1f;
		
		//imgui ui element 
		{
			static float f = 0.0f;
			static int counter = 0;
			ImGui::Text("Hello, world!");                           // Display some text (you can use a format string too)
			ImGui::SliderFloat3("Translation", &translation.x, 0.0f, 960.0f);            // Edit 1 float using a slider from 0.0f to 1.0f    
			ImGui::ColorEdit3("mainColor", (float*)&mainColor);
			ImGui::Text("Application average %.3f ms/frame (%.1f FPS)", 1000.0f / ImGui::GetIO().Framerate, ImGui::GetIO().Framerate);
		}
		//imgui
		ImGui::Render();
		ImGui_ImplGlfwGL3_RenderDrawData(ImGui::GetDrawData());

		/* Swap front and back buffers */
		glfwSwapBuffers(window);

		/* Poll for and process events */
		glfwPollEvents();
	}

	//imgui
	ImGui_ImplGlfwGL3_Shutdown();
	ImGui::DestroyContext();
	glfwTerminate();
	return 0;
}
```

![21.IMGUI_image_1](assets/21.IMGUI_image_1.png)

